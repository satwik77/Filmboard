{% load staticfiles %}
<head>
<meta charset="UTF-8">
<meta name="google-signin-client_id" content="1088023128022-u9aoktgdhn5pldfo9k7iolti6tk7mia9.apps.googleusercontent.com">
<script src="https://apis.google.com/js/platform.js" async defer></script>
<style>
 .abcRioButtonLightBlue
 {
	 height:inherit;
	 width:inherit;
	 background-color:#000;
	 color:#fff;
 }
 .btn {
      display: inline-block;
      position: relative;
      width: 120px;
      height: 32px;
      line-height: 32px;
      border-radius: 2px;
      font-size: 0.9em;
      background-color: #fff;
      color: #646464;
    }
	.btn.blue {
      background-color: #4285f4;
      color: #fff;
    }
	.btn.raised {
      transition: box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      transition-delay: 0.2s;
      box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.26);
    }
    
    .btn.raised:active {
      box-shadow: 0 8px 17px 0 rgba(0, 0, 0, 0.2);
      transition-delay: 0s;
    }
	</style>
</head>
{% block body %}
<div class="materialContainer container">
	<div class="row">
		<div class="twelve columns textcenter box">
        <div style="position:relative;top:-50px;">
		<h1 class="title">Login</h1>
			{% csrf_token %}
			<form action='../login/' method='POST' id="login_form">
            <script>
  				window.fbAsyncInit = function() {
  					FB.init({
				    appId      : '1671135289821610',
    				cookie     : true,  // enable cookies to allow the server to access 
                        // the session
 				    xfbml      : true,  // parse social plugins on this page
  				    version    : 'v2.2' // use version 2.2
 			 });};
	
			  // Load the SDK asynchronously
			  (function(d, s, id) {
				    var js, fjs = d.getElementsByTagName(s)[0];
				    if (d.getElementById(id)) return;
	  			    js = d.createElement(s); js.id = id;
	 			    js.src = "//connect.facebook.net/en_US/sdk.js";
	  			    fjs.parentNode.insertBefore(js, fjs);
 		  	  }(document, 'script', 'facebook-jssdk'));

 			 function testAPI() {
    			console.log('Welcome!  Fetching your information.... ');
  			    FB.api('/me', function(response) {
     		    console.log('Successful login for: ' + response.name);
				console.log(response.email);
    		    console.log(JSON.stringify(response));
    		 });
  			}
			function initFbLogin() {
				 FB.login(function(response) {
			     	if (response.status === 'connected') {
			        // Logged into your app and Facebook.
     			    testAPI();
   				    } else if (response.status === 'not_authorized') {
     			    // The person is logged into Facebook, but not your app.
   				   $('.error_login').innerHTML = 'Please log ' +
    		       'into this app.';
 				   } else {
    			   // The person is not logged into Facebook, so we're not sure if
    			   // they are logged into this app or not.
   				   $('.error_login').innerHTML = 'Please log ' +
    		       'into this app.';
  				   }
				 
 				 }, {scope: 'public_profile,email'});
			}
</script>

<!--
  Below we include the Login Button social plugin. This button uses
  the JavaScript SDK to present a graphical Login button that triggers
  the FB.login() function when clicked.
-->
    <div id="social-plugins">
		
     </div>
        	{% csrf_token %}
                <div class="input">
					<label for="username">Username</label>
					<input type="text" maxlength="254" name="username" />
                    <span class="spin"></span>
                </div>
                <div class="input">
         			<label for="password">Password:</label>
					<input type="password" name="password" ><br/>
                	<span class="spin"></span>
                </div>
				<a id="register-link" class="button" href="../register/">Register</a>
                <p class="error_login">Invalid login credentials</p>
				<div class="button login" style="margin-bottom:10px">
                <button class="button button-primary" type="submit" name="submit" value="Login" id='login-submit'> <span>GO</span><i class="fa fa-check">&#10003;</i> </button>
			</form>			
		</div>
       <div class="row input" id="guest-value" style="float:left;height:20px;color:#000;border-top:#000 1px solid;margin-bottom:10px;text-align:center"><span style="color:#000;">
        Artist</span>&nbsp;<input type ='radio' name = 'choice' value = 'talent' class="css-checkbox" style="height:auto;width:auto;float:none;top:0">  &nbsp;
        <span style="color:#000;">Allied Services</span>&nbsp;<input type = 'radio' name = 'choice' value = 'service' class="css-checkbox" style="height:auto;width:auto;float:none;top:0">   &nbsp;
        <span style="color:#000;">Production House</span>&nbsp;<input type ='radio' name = 'choice' value = 'producer' class="css-checkbox" style="height:auto;width:auto;float:none;top:0" > 
      </div>
       <div class="social-wrap c" style="float:left">
    		<button class="facebook" onclick="initFbLogin()" disabled="disabled"><em>w/</em> Facebook</button>
    		<span class="g-signin"><button class="g-signin2" disabled="disabled" data-onsuccess="onSignIn"  style="background: #000;padding: 0;width:120px;"></button></span>
            <div class="btn raised blue">
      		<div class="center"><a id="guest-link"  >Login as Guest</a></div>
            
       		</div>
		</div>
        
     	
    	
        </div>
        </div>
        <div class="overbox">
      		<div class="material-button alt-2" id="register_call"><span class="shape"></span></div>
      		<div class="reg-div" style="position:relative;top:-56px">
            <div class="title">REGISTER</div>
		    <div class="input">
        		 <label for="regname">Username</label>
         		<input type="text" name="regname" id="regname">
         		<span class="spin"></span>
      		</div>
	        <div class="input">
      		   <label for="regpass">Password</label>
         		<input type="password" name="regpass" id="regpass">
         		<span class="spin"></span>
      		</div>
	        <div class="input">
      		   <label for="reregpass">Repeat Password</label>
         	   <input type="password" name="reregpass" id="reregpass">
         	   <span class="spin"></span>
      		</div>
	        <div class="button">
      		   <button><span>NEXT</span></button>
      		</div>
            </div>
	   </div>
	</div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script>
var parentdiv = $('#login_form').parent().parent();
var error = '';
$('#login_form').submit(function(e) {
    e.preventDefault();
	console.log('login');
	 $.ajax({
  url: "http://filmboard.ml/login/",
  beforeSend:function(xhr, settings) {
                    function getCookie(name) {
                            var cookieValue = null;
                           if (document.cookie && document.cookie != '') {
                           var cookies = document.cookie.split(';');
                            for (var i = 0; i < cookies.length; i++) {
                            var cookie = jQuery.trim(cookies[i]);
                                  if (cookie.substring(0, name.length + 1) == (name + '=')) {
                                       cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                        break;
                                   }
                                }
                           }
                            return cookieValue;
                       }
                      if (settings.url == "your-url")
                            xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
 },
  method : "POST",
  data: $('#login_form').serialize()
}).done(function(data) {
	console.log(data);
	error = data;
	if(error.search("Invalid Login Credentials") != -1)
	$('.error_login').css('opacity',1);
	else {
	$('.error_login').css('opacity',0);
    window.location.href ="http://filmboard.ml/dashboard";
	}
   
  }); });
  
  $(function() {

   $(".input input").focus(function() {

      $(this).parent(".input").each(function() {
         $("label", this).css({
            "line-height": "18px",
            "font-size": "18px",
            "font-weight": "100",
            "top": "0px"
         })
         $(".spin", this).css({
            "width": "100%"
         })
      });
   }).blur(function() {
      $(".spin").css({
         "width": "0px"
      })
      if ($(this).val() == "") {
         $(this).parent(".input").each(function() {
            $("label", this).css({
               "line-height": "60px",
               "font-size": "24px",
               "font-weight": "300",
               "top": "10px"
            })
         });

      }
   });

   $(".button").click(function(e) {
      var pX = e.pageX,
         pY = e.pageY,
         oX = parseInt($(this).offset().left),
         oY = parseInt($(this).offset().top);

      $(this).append('<span class="click-efect x-' + oX + ' y-' + oY + '" style="margin-left:' + (pX - oX) + 'px;margin-top:' + (pY - oY) + 'px;"></span>')
      $('.x-' + oX + '.y-' + oY + '').animate({
         "width": "500px",
         "height": "500px",
         "top": "-250px",
         "left": "-250px",

      }, 600);
      $("button", this).addClass('active');
   })

   $(".alt-2").click(function() {
      if (!$(this).hasClass('material-button')) {
         $(".shape").css({
            "width": "100%",
            "height": "100%",
            "transform": "rotate(0deg)"
         })

         setTimeout(function() {
            $(".overbox").css({
               "overflow": "initial"
            })
         }, 600)

         $(this).animate({
            "width": "140px",
            "height": "140px"
         }, 500, function() {
            $(".box").removeClass("back");

            $(this).removeClass('active')
         });

         $(".overbox .title").fadeOut(300);
         $(".overbox .input").fadeOut(300);
         $(".overbox .button").fadeOut(300);

         $(".alt-2").addClass('material-buton');
      }

   })

   $(".material-button").click(function() {

      if ($(this).hasClass('material-button')) {
         setTimeout(function() {
            $(".overbox").css({
               "overflow": "hidden"
            })
            $(".box").addClass("back");
         }, 200)
         $(this).addClass('active').animate({
            "width": "700px",
            "height": "700px"
         });

         setTimeout(function() {
            $(".shape").css({
               "width": "50%",
               "height": "50%",
               "transform": "rotate(45deg)"
            })

            $(".overbox .title").fadeIn(300);
            $(".overbox .input").fadeIn(300);
            $(".overbox .button").fadeIn(300);
         }, 700)

         $(this).removeClass('material-button');

      }

      if ($(".alt-2").hasClass('material-buton')) {
         $(".alt-2").removeClass('material-buton');
         $(".alt-2").addClass('material-button');
      }

   });

});
$('#register_call').click(function(e) {
$.ajax({
  url: "http://filmboard.ml/register/",
  method : "GET"
}).done(function( html ) {
	
    $( ".reg-div" ).html( html );
  }); });   
var sdata = {"":""};
function onSignIn(googleUser) {
  var profile = googleUser.getBasicProfile();
  var profileId = profile.getId(),
  	  profileName = profile.getName(),
	  profileMail = profile.getEmail();
 //console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
 //console.log('Name: ' + profile.getName());
 //console.log('Image URL: ' + profile.getImageUrl());
 //console.log('Email: ' + profile.getEmail());
 sdata= {"profileId": profileId,
             "profileName": profileName, 
             "profileMail": profileMail};
 console.log(sdata);
}
$('.g-signin').click(function() {
	console.log(sdata);
	 $.ajax({
    	 url: "http://filmboard.ml/applyGoogle/",
    	 type: "POST",
    	 data: sdata,
    	 // dataType: "json",
    	 // contentType: "application/json",
    	 success: function (data) {
    	           console.log(data);
                  if(data.status==1)
				     window.location.href = "http://filmboard.ml/dashboard/";
                 else if(data.status==2)
                   window.location.href = "http://filmboard.ml/googlereg/";
                },
		
  });});

$('#guest-value input').click(function() {
	$('.social-wrap button').removeAttr("disabled");
	//console.log('click');
	var guestValue = $(this).val();
	//console.log(guestValue);
	var guestLink = 'http://filmboard.ml/guest_' + guestValue;
	//console.log(guestLink);
	$('#guest-link').attr("href", guestLink);
});
</script>
{% endblock body %}